{"version":3,"sources":["../../../../src/database/repositories/club.repository.js"],"names":["addClub","club","save","findClubById","id","Promise","resolve","reject","findOne","err","findClubByObjectId","_id","getAllClubs","find","clubs","removeCustomerById","customerId","index","i","usersClub","forEach","userClub","splice","addSale","sale","sales","push","findSale","saleId","removeSale","addPointsToClub","points","equals","parseInt","Points","RemovePointsFromClub","changeInfo","clubId","itemIndex","newItem","then","console","log","catch","changeSaleInfo","addBranch","branchId","branch","branches","indexOf","removeBranch"],"mappings":"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","file":"club.repository.js","sourcesContent":["import ClubModel from '../../models/club-model';\r\n\r\nexport default {\r\n\r\n    addClub(club) {\r\n        club.save();\r\n    },\r\n    findClubById(id) {\r\n        return new Promise((resolve, reject) => {\r\n            ClubModel.findOne({id: id}, (err, club) => {\r\n                if (err) reject(err);\r\n                else resolve(club);\r\n            });\r\n        });\r\n    },\r\n    findClubByObjectId(id) {\r\n        return new Promise((resolve, reject) => {\r\n            ClubModel.findOne({_id: id}, (err, club) => {\r\n                if (err) reject(err);\r\n                else resolve(club);\r\n            });\r\n        });\r\n    },\r\n    getAllClubs() {\r\n        return new Promise((resolve, reject) => {\r\n            ClubModel.find({}, (err, clubs) => {\r\n                if(err) reject(err);\r\n                else resolve(clubs);\r\n            });\r\n        });\r\n    },\r\n    removeCustomerById(club, customerId){\r\n        let index = 0;\r\n        let i = 0;\r\n        club.usersClub.forEach((userClub) => {\r\n            if(userClub.customerId == customerId)\r\n                index = i;\r\n            i++;\r\n        });\r\n\r\n        club.usersClub.splice(index, 1);\r\n        club.save();\r\n    },\r\n    addSale(club, sale)\r\n    {\r\n         club.sales.push(sale);\r\n         club.save();\r\n    },\r\n    findSale(club, saleId)\r\n    {\r\n        return club.sales.find(sale => sale.id == saleId)\r\n    },\r\n    removeSale(club, saleId)\r\n    {\r\n        let i = 0;\r\n        let index = 0;\r\n        club.sales.forEach(function(sale) {\r\n            if(sale.id == saleId)\r\n            {\r\n                index = i;\r\n            }\r\n            i++;\r\n        });\r\n        club.sales.splice(index, 1);\r\n        club.save();\r\n    },\r\n    addPointsToClub(club, customerId, points){\r\n         club.usersClub.forEach(function(userClub) {\r\n                if(customerId.equals(userClub.customerId))\r\n                {\r\n                    userClub.points =  parseInt(userClub.Points) + parseInt(points);\r\n                }\r\n             });\r\n             club.save();\r\n   },\r\n   RemovePointsFromClub(club, customerId, points){\r\n         club.usersClub.forEach(function(userClub) {\r\n                if(customerId.equals(userClub.customerId))\r\n                {\r\n                    userClub.points =  parseInt(userClub.points) - parseInt(points);\r\n                }\r\n             });\r\n             club.save();\r\n   },\r\n    changeInfo(clubId, itemIndex, newItem)\r\n    {\r\n        this.findClubById(clubId)\r\n        .then(club => {\r\n            if(club)\r\n            {\r\n                club[itemIndex] = newItem;\r\n                club.save();\r\n            }\r\n            else { console.log(\"club not found\"); }\r\n        })\r\n        .catch(err => { console.log(err); });\r\n     },\r\n    changeSaleInfo(clubId, saleId, itemIndex, newItem)\r\n     {\r\n        this.findClubById(clubId)\r\n        .then(club => {\r\n            if(club)\r\n            {\r\n                let sale = this.findSale(club, saleId)\r\n                if(sale){\r\n                    sale[itemIndex] = newItem;\r\n                    club.save();\r\n                }\r\n                else{\r\n                    console.log(\"Sale wasnt found\");\r\n                }\r\n\r\n            }\r\n            else { console.log(\"Club not found\"); }\r\n        })\r\n        .catch(err => { console.log(err); });\r\n     },\r\n     addBranch(clubId, branchId)\r\n     {\r\n         this.findClubById(clubId)\r\n         .then(club => {\r\n             if(club)\r\n             {\r\n                this.findClubById(branchId)\r\n                .then(branch => {\r\n                    if(branch)\r\n                    {\r\n                        if(club.branches.indexOf(branch._id) == -1)\r\n                            {\r\n                                club.branches.push(branch._id);\r\n                                club.save();\r\n                            }\r\n                    }\r\n                    else {console.log(\"Branch wasnt found\"); }\r\n                })\r\n                .catch(err => { console.log(err); })\r\n             }\r\n             else {console.log(\"Club wasnt found\"); }\r\n         })\r\n         .catch(err => { console.log(err); });\r\n     },\r\n     removeBranch(clubId, branchId)\r\n     {\r\n         this.findClubById(clubId)\r\n         .then(club => {\r\n             if(club)\r\n             {\r\n                 this.findClubById(branchId)\r\n                 .then(branch => {\r\n                     if(branch)\r\n                     {\r\n                         let index = club.branches.indexOf(branch._id);\r\n                         club.branches.splice(index, 1);\r\n                         club.save();\r\n                     }\r\n                     else { console.log(\"Branch wasnt found\"); }\r\n                 })\r\n                 .catch(err => { console.log(err); })\r\n             }\r\n             else { console.log(\"Club wasnt found\"); }\r\n         })\r\n         .catch(err => { console.log(err); });\r\n     }\r\n}\r\n"]}